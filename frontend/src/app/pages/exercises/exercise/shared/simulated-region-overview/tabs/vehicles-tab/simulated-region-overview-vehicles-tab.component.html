<div class="container d-flex flex-row h-100" style="min-height: 0; gap: 4px">
    <div class="col mh-100 overflow-auto" style="max-width: 30%">
        <ng-container
            *ngIf="(groupedVehicles$ | async)?.length; else noVehicles"
        >
            <table
                *ngFor="
                    let vehicleGroup of groupedVehicles$ | async;
                    trackBy: 'vehicleType'
                        | appTrackByProperty : (groupedVehicles$ | async)
                "
                class="table table-striped table-hover"
            >
                <thead>
                    <tr>
                        <th scope="col">{{ vehicleGroup.vehicleType }}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr
                        *ngFor="
                            let vehicle of vehicleGroup.vehicles;
                            trackBy: 'id'
                                | appTrackByProperty : vehicleGroup.vehicles
                        "
                        style="cursor: pointer"
                        (click)="selectVehicle(vehicle.id)"
                        [class.table-primary]="
                            (selection$ | async)?.vehicle?.id === vehicle.id
                        "
                    >
                        <td>
                            {{ vehicle.name }}
                        </td>
                    </tr>
                </tbody>
            </table></ng-container
        >
        <ng-template #noVehicles>
            <p class="text-muted">
                Es befinden sich keine Fahrzeuge im simulierten Bereich.
            </p>
        </ng-template>
    </div>
    <div class="vr"></div>
    <div class="col overflow-auto" style="max-width: 70%">
        <ng-container
            *ngIf="selection$ | async as selection; else noSelectedVehicle"
        >
            <div class="mb-3">
                <h6>Fahrzeugname</h6>
                <app-vehicle-name-editor [vehicleId]="selection.vehicle.id" />
            </div>
            <div class="mb-3">
                <h6>Personal</h6>
                <ul>
                    <li *ngFor="let personnel of selection.personnel">
                        {{ personnel.personnelType | personnelName }}
                        <span
                            *ngIf="personnel.isInVehicle; else notInVehicle"
                            class="text-muted"
                        >
                            (im Fahrzeug)
                        </span>
                        <ng-template #notInVehicle>
                            <span class="text-muted"> (ausgestiegen) </span>
                        </ng-template>
                    </li>
                </ul>
                <app-vehicle-load-unload-controls
                    [vehicleId]="selection.vehicle.id"
                />
            </div>
            <div class="mb-3">
                <h6>Patienten</h6>
                <app-vehicle-available-slots-display
                    [vehicleId]="selection.vehicle.id"
                />
                <app-simulated-region-overview-patients-table
                    [patients]="selection.patients"
                    scope="vehicle"
                />
            </div>
        </ng-container>
        <ng-template #noSelectedVehicle>
            <p class="text-muted">
                Bitte w√§hlen Sie eine Fahrzeug links aus der Liste, um dessen
                Details zu betrachten.
            </p>
        </ng-template>
    </div>
</div>
